(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7085:function(e,t,s){Promise.resolve().then(s.t.bind(s,2445,23)),Promise.resolve().then(s.bind(s,481)),Promise.resolve().then(s.bind(s,809)),Promise.resolve().then(s.t.bind(s,5245,23)),Promise.resolve().then(s.bind(s,6336)),Promise.resolve().then(s.bind(s,1745)),Promise.resolve().then(s.bind(s,538)),Promise.resolve().then(s.bind(s,8961))},9461:function(e,t,s){"use strict";var l=s(3827),n=s(4090),r=s(1367);let i=(0,n.forwardRef)((e,t)=>{let{className:s,children:n,disabled:i,type:a="button",...o}=e;return(0,l.jsx)("button",{type:a,className:(0,r.m6)("w-full rounded-full bg-blue-500 border border-transparent px-3 py-3 disabled:cursor-not-allowed disabled:opacity-50 text-black font-bold hover:opacity-75 transition",s),disabled:i,ref:t,...o,children:n})});i.displayName="Button",t.Z=i},7578:function(e,t,s){"use strict";var l=s(3827),n=s(4090),r=s(1367);let i=(0,n.forwardRef)((e,t)=>{let{className:s,type:n,disabled:i,...a}=e;return(0,l.jsx)("input",{type:n,className:(0,r.m6)("flex w-full rounded-md bg-neutral-700 border border-transparent px-3 py-3 text-sm file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-neutral-400 diabled:cursor-not-allowed disabled:opacity-50 focus:outline-none",s),disabled:i,ref:t,...a})});i.displayName="Input",t.Z=i},3204:function(e,t,s){"use strict";var l=s(3827),n=s(4090),r=s(6128),i=s(7907),a=s(8009),o=s(9509),d=s(9710),u=s(5405);t.Z=e=>{let{songId:t}=e,s=(0,i.useRouter)(),{supabaseClient:c}=(0,o.useSessionContext)(),f=(0,u.Z)(),{user:x}=(0,d.aF)(),[m,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(null==x?void 0:x.id)&&(async()=>{let{data:e,error:s}=await c.from("liked_songs").select("*").eq("user_id",x.id).eq("song_id",t).single();!s&&e&&h(!0)})()},[t,c,null==x?void 0:x.id]);let p=m?r.M_L:r.lo,g=async()=>{if(!x)return f.onOpen();if(m){let{error:e}=await c.from("liked_songs").delete().eq("user_id",x.id).eq("song_id",t);e?a.Am.error(e.message):h(!1)}else{let{error:e}=await c.from("liked_songs").insert({song_id:t,user_id:x.id});e?a.Am.error(e.message):(h(!0),a.Am.success("Success"))}s.refresh()};return(0,l.jsx)("button",{className:"   cursor-pointer    hover:opacity-75    transition   ",onClick:g,children:(0,l.jsx)(p,{color:m?"#4dabf7":"white",size:25})})}},497:function(e,t,s){"use strict";var l=s(3827),n=s(9704);s(4090);var r=s(703);t.Z=e=>{let{data:t,onClick:s}=e,i=(0,n.Z)(t);return(0,l.jsxs)("div",{onClick:()=>{if(s)return s(t.id)},className:"flex items-center gap-x-3 cursor-pointer hover:bg-neutral-800/50 w-full p-2 rounded-md",children:[(0,l.jsx)("div",{className:"relative rounded-md min-h-[48px] min-w-[48px] overflow-hidden",children:(0,l.jsx)(r.default,{fill:!0,src:i||"/image/liked.png",alt:"Media Item",className:"object-cover"})}),(0,l.jsxs)("div",{className:"flex flex-col gap-y-1 overflow-hidden",children:[(0,l.jsx)("p",{className:"text-white truncate",children:t.title}),(0,l.jsx)("p",{className:"text-neutral-400 text-sm truncate",children:t.artist})]})]})}},481:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var l=s(3827),n=s(4090),r=s(7146),i=s(9509),a=e=>{let t=(0,i.useSupabaseClient)();if(!e)return"";let{data:s}=t.storage.from("songs").getPublicUrl(e.song_path);return s.publicUrl},o=s(8009),d=e=>{let[t,s]=(0,n.useState)(!1),[l,r]=(0,n.useState)(void 0),{supabaseClient:a}=(0,i.useSessionContext)();return(0,n.useEffect)(()=>{e&&(s(!0),(async()=>{let{data:t,error:l}=await a.from("songs").select("*").eq("id",e).single();if(l)return s(!1),o.Am.error(l.message);r(t),s(!1)})())},[e,a]),(0,n.useMemo)(()=>({isLoading:t,song:l}),[t,l])},u=s(9400),c=s(1975),f=s(6733),x=s(6128),m=s(3204),h=s(497),p=s(6532),g=e=>{let{value:t=1,onChange:s}=e;return(0,l.jsx)(p.fC,{className:"relative flex items-center select-none touch-none w-full h-10",defaultValue:[1],value:[t],onValueChange:e=>{null==s||s(e[0])},max:1,step:.1,"aria-label":"Volume",children:(0,l.jsx)(p.fQ,{className:"bg-neutral-600 relative grow rounded-full h-[3px]",children:(0,l.jsx)(p.e6,{className:"absolute bg-white rounded-full h-full"})})})},v=e=>{let{song:t,songUrl:s}=e,i=(0,r.Z)(),[a,o]=(0,n.useState)(1),[d,p]=(0,n.useState)(!1),v=d?c.wRS:c.W9m,b=0===a?f.Iko:f.MVT,j=()=>{if(0===i.ids.length)return;let e=i.ids.findIndex(e=>e===i.activeId),t=i.ids[e+1];if(!t)return i.setId(i.ids[0]);i.setId(t)},[w,{pause:N,sound:C}]=(0,u.Z)(s,{volume:a,onplay:()=>p(!0),onend:()=>{p(!1),j()},onpause:()=>p(!1),format:["mp3"]});(0,n.useEffect)(()=>(null==C||C.play(),()=>{null==C||C.unload()}),[C]);let y=()=>{d?N():w()};return(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 h-full",children:[(0,l.jsx)("div",{className:"flex w-full justify-start",children:(0,l.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,l.jsx)(h.Z,{data:t}),(0,l.jsx)(m.Z,{songId:t.id})]})}),(0,l.jsx)("div",{className:"   flex    md:hidden    col-auto    w-full    justify-end    items-center   ",children:(0,l.jsx)("div",{onClick:y,className:"   h-10   w-10   flex    items-center    justify-center    rounded-full    bg-white    p-1    cursor-pointer   ",children:(0,l.jsx)(v,{size:30,className:"text-black"})})}),(0,l.jsxs)("div",{className:"   hidden   h-full   md:flex    justify-center    items-center    w-full    max-w-[722px]    gap-x-6   ",children:[(0,l.jsx)(x.KCK,{onClick:()=>{if(0===i.ids.length)return;let e=i.ids.findIndex(e=>e===i.activeId),t=i.ids[e-1];if(!t)return i.setId(i.ids[i.ids.length-1]);i.setId(t)},size:30,className:"   text-neutral-400    cursor-pointer    hover:text-white    transition   "}),(0,l.jsx)("div",{onClick:y,className:"   flex    items-center    justify-center   h-10   w-10    rounded-full    bg-white    p-1    cursor-pointer   ",children:(0,l.jsx)(v,{size:30,className:"text-black"})}),(0,l.jsx)(x.tfD,{onClick:j,size:30,className:"   text-neutral-400    cursor-pointer    hover:text-white    transition   "})]}),(0,l.jsx)("div",{className:"hidden md:flex w-full justify-end pr-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-x-2 w-[120px]",children:[(0,l.jsx)(b,{onClick:()=>{0===a?o(1):o(0)},className:"cursor-pointer",size:34}),(0,l.jsx)(g,{value:a,onChange:e=>o(e)})]})})]})},b=e=>{let{}=e,t=(0,r.Z)(),{song:s}=d(t.activeId),n=a(s);return s&&n&&t.activeId?(0,l.jsx)("div",{className:"fixed bottom-0 bg-black w-full py-2 h-[80px] px-4",children:(0,l.jsx)(v,{song:s,songUrl:n},n)}):null}},809:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var l=s(3827),n=s(7907),r=s(4090),i=s(8641),a=s(9908),o=s(1367),d=e=>{let{children:t,className:s}=e;return(0,l.jsx)("div",{className:(0,o.m6)("\n      bg-neutral-900\n        rounded-lg\n        h-fit,\n        w-full",s),children:t})},u=s(8792),c=e=>{let{icon:t,label:s,active:n,href:r}=e;return(0,l.jsxs)(u.default,{href:r,className:(0,o.m6)("\n      flex\n      flex-row\n      h-auto\n      items-center\n      w-full\n      gap-x-4\n      text-md\n      font-medium\n      cursor-pointer\n      hover:text-white\n      transition\n      text-neutral-400\n      py-1",n&&"text-white"),children:[(0,l.jsx)(t,{size:26}),(0,l.jsx)("p",{className:"truncate w-full",children:s})]})},f=s(5405),x=s(2214),m=s(9710),h=s(6128),p=s(102),g=s(497),v=s(5667),b=e=>{let{songs:t}=e,s=(0,f.Z)(),n=(0,x.Z)(),{user:r}=(0,m.aF)(),i=(0,v.Z)(t);return(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-5 pt-4",children:[(0,l.jsxs)("div",{className:"inline-flex items-center gap-x-2",children:[(0,l.jsx)(p.XUn,{className:"text-neutral-400",size:26}),(0,l.jsx)("p",{className:"text-neutral-400 font-medium text-md",children:"Your Library"})]}),(0,l.jsx)(h.Lfi,{onClick:()=>r?n.onOpen():s.onOpen(),size:20,className:"text-neutral-400 cursor-pointer hover:text-white transition"})]}),(0,l.jsx)("div",{className:"flex flex-col gap-y-2 mt-4 px-3",children:t.map(e=>(0,l.jsx)(g.Z,{onClick:e=>{i(e)},data:e},e.id))})]})},j=s(7146),w=e=>{let{children:t,songs:s}=e,u=(0,n.usePathname)(),f=(0,j.Z)(),x=(0,r.useMemo)(()=>[{icon:a.g3P,label:"Home",active:"/search"!==u,href:"/"},{icon:i.Goc,label:"Search",active:"/search"===u,href:"/search"}],[u]);return(0,l.jsxs)("div",{className:(0,o.m6)("flex h-full",f.activeId&&"h-[calc(100%-80px)]"),children:[(0,l.jsxs)("div",{className:"hidden    md:flex    flex-col    gap-y-2    bg-black    h-full    w-[300px]    p-2",children:[(0,l.jsx)(d,{children:(0,l.jsx)("div",{className:"flex flex-col gap-y-4 px-5 py-4",children:x.map(e=>(0,l.jsx)(c,{...e},e.label))})}),(0,l.jsx)(d,{className:"overflow-y-auto h-full",children:(0,l.jsx)(b,{songs:s})})]}),(0,l.jsx)("main",{className:"h-full flex-1 overflow-y-auto py-2",children:t})]})}},9704:function(e,t,s){"use strict";var l=s(9509);t.Z=e=>{let t=(0,l.useSupabaseClient)();if(!e)return null;let{data:s}=t.storage.from("images").getPublicUrl(e.image_path);return s.publicUrl}},5405:function(e,t,s){"use strict";let l=(0,s(2020).Ue)(e=>({isOpen:!1,onOpen:()=>e({isOpen:!0}),onClose:()=>e({isOpen:!1})}));t.Z=l},5667:function(e,t,s){"use strict";var l=s(7146),n=s(5405),r=s(9710);t.Z=e=>{let t=(0,l.Z)(),s=(0,n.Z)(),{user:i}=(0,r.aF)();return l=>{if(!i)return s.onOpen();t.setId(l),t.setIds(e.map(e=>e.id))}}},7146:function(e,t,s){"use strict";let l=(0,s(2020).Ue)(e=>({ids:[],activeId:void 0,setId:t=>e({activeId:t}),setIds:t=>e({ids:t}),reset:()=>e({ids:[],activeId:void 0})}));t.Z=l},2214:function(e,t,s){"use strict";let l=(0,s(2020).Ue)(e=>({isOpen:!1,onOpen:()=>e({isOpen:!0}),onClose:()=>e({isOpen:!1})}));t.Z=l},9710:function(e,t,s){"use strict";s.d(t,{Di:function(){return a},aF:function(){return o}});var l=s(3827),n=s(4090),r=s(9509);let i=(0,n.createContext)(void 0),a=e=>{var t;let{session:s,isLoading:a,supabaseClient:o}=(0,r.useSessionContext)(),d=(0,r.useUser)(),u=null!==(t=null==s?void 0:s.access_token)&&void 0!==t?t:null,[c,f]=(0,n.useState)(!1),[x,m]=(0,n.useState)(null),[h,p]=(0,n.useState)(null),g=()=>o.from("users").select("*").single(),v=()=>o.from("subscriptions").select("*, prices(*, products(*))").in("status",["trialing","active"]).single();return(0,n.useEffect)(()=>{!d||c||x||h?d||a||c||(m(null),p(null)):(f(!0),Promise.allSettled([g(),v()]).then(e=>{let t=e[0],s=e[1];"fulfilled"===t.status&&m(t.value.data),"fulfilled"===s.status&&p(s.value.data),f(!1)}))},[d,a]),(0,l.jsx)(i.Provider,{value:{accessToken:u,user:d,userDetails:x,isLoading:a||c,subscription:h},...e})},o=()=>{let e=(0,n.useContext)(i);if(void 0===e)throw Error("useUser must be used within a MyUserContextProvider");return e}},6336:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var l=s(3827),n=s(4090),r=s(9509),i=s(4687),a=s(8796),o=e=>{let{isOpen:t,onChange:s,title:n,description:r,children:o}=e;return(0,l.jsx)(i.fC,{open:t,defaultOpen:t,onOpenChange:s,children:(0,l.jsxs)(i.h_,{children:[(0,l.jsx)(i.aV,{className:"   bg-neutral-900/90    backdrop-blur-sm    fixed    inset-0   "}),(0,l.jsxs)(i.VY,{className:"   fixed    drop-shadow-md    border    border-neutral-700    top-[50%]    left-[50%]    max-h-full    h-full    md:h-auto    md:max-h-[85vh]    w-full    md:w-[90vw]    md:max-w-[450px]    translate-x-[-50%]    translate-y-[-50%]    rounded-md    bg-neutral-800    p-[25px]    focus:outline-none   ",children:[(0,l.jsx)(i.Dx,{className:"   text-xl    text-center    font-bold    mb-4   ",children:n}),(0,l.jsx)(i.dk,{className:"   mb-5    text-sm    leading-normal    text-center   ",children:r}),(0,l.jsx)("div",{children:o}),(0,l.jsx)(i.x8,{asChild:!0,children:(0,l.jsx)("button",{className:"   text-neutral-400    hover:text-white    absolute    top-[10px]    right-[10px]    inline-flex    h-[25px]    w-[25px]    appearance-none    items-center    justify-center    rounded-full    focus:outline-none   ","aria-label":"Close",children:(0,l.jsx)(a.QAE,{})})})]})]})})},d=s(7907),u=s(6576),c=s(127),f=s(5405),x=()=>{let e=(0,r.useSupabaseClient)(),t=(0,d.useRouter)(),{session:s}=(0,r.useSessionContext)(),{onClose:i,isOpen:a}=(0,f.Z)();return(0,n.useEffect)(()=>{s&&(t.refresh(),i())},[s,t,i]),(0,l.jsx)(o,{title:"Welcome back",description:"Login to your account",isOpen:a,onChange:e=>{e||i()},children:(0,l.jsx)(u.gx,{theme:"dark",magicLink:!0,providers:["github"],supabaseClient:e,appearance:{theme:c.rD,variables:{default:{colors:{brand:"#404040",brandAccent:" #0066cc"}}}}})})},m=s(1146),h=s.n(m),p=s(2214),g=s(2670),v=s(7578),b=s(9461),j=s(8009),w=s(9710),N=()=>{let[e,t]=(0,n.useState)(!1),s=(0,p.Z)(),{user:i}=(0,w.aF)(),a=(0,r.useSupabaseClient)(),u=(0,d.useRouter)(),{register:c,handleSubmit:f,reset:x}=(0,g.cI)({defaultValues:{title:"",artist:"",image:null,song:null}}),m=async e=>{try{var l,n;t(!0);let r=null===(l=e.image)||void 0===l?void 0:l[0],o=null===(n=e.song)||void 0===n?void 0:n[0];if(!r||!o||!i){j.ZP.error("Missing fields");return}let d=h()(),{data:c,error:f}=await a.storage.from("songs").upload("song-".concat(e.title,"-").concat(d),o,{cacheControl:"3600",upsert:!1});if(f)return t(!1),j.ZP.error("Song failed to upload");let{data:m,error:p}=await a.storage.from("images").upload("image-".concat(e.title,"-").concat(d),r,{cacheControl:"3600",upsert:!1});if(p)return t(!1),j.ZP.error("Image failed to upload");let{error:g}=await a.from("songs").insert({user_id:i.id,title:e.title,artist:e.artist,song_path:c.path,image_path:m.path});if(g)return j.ZP.error(g.message);u.refresh(),t(!1),j.ZP.success("Song uploaded!"),x(),s.onClose()}catch(e){j.ZP.error("Something went wrong")}finally{t(!1)}};return(0,l.jsx)(o,{title:"Add a song",description:"Upload an mp3 file",isOpen:s.isOpen,onChange:e=>{e||(x(),s.onClose())},children:(0,l.jsxs)("form",{onSubmit:f(m),className:"flex flex-col gap-y-4",children:[(0,l.jsx)(v.Z,{id:"title",disabled:e,...c("title",{required:!0}),placeholder:"Song title"}),(0,l.jsx)(v.Z,{id:"artist",disabled:e,...c("artist",{required:!0}),placeholder:"Song artist"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"pb-1",children:"Select a song file"}),(0,l.jsx)(v.Z,{id:"song",type:"file",disabled:e,accept:".mp3",...c("song",{required:!0})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"pb-1",children:"Select an image"}),(0,l.jsx)(v.Z,{id:"image",type:"file",disabled:e,accept:"image/*",...c("image",{required:!0})})]}),(0,l.jsx)(b.Z,{disabled:e,type:"submit",children:"Create"})]})})},C=()=>{let[e,t]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{t(!0)},[]),e)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x,{}),(0,l.jsx)(N,{})]}):null}},1745:function(e,t,s){"use strict";s.r(t);var l=s(3827),n=s(4090),r=s(8714),i=s(9509);t.default=e=>{let{children:t}=e,[s]=(0,n.useState)(()=>(0,r.createClientComponentClient)());return(0,l.jsx)(i.SessionContextProvider,{supabaseClient:s,children:t})}},538:function(e,t,s){"use strict";s.r(t);var l=s(3827),n=s(8009);t.default=()=>(0,l.jsx)(n.x7,{toastOptions:{style:{background:"#333",color:"#fff"}}})},8961:function(e,t,s){"use strict";s.r(t);var l=s(3827),n=s(9710);t.default=e=>{let{children:t}=e;return(0,l.jsx)(n.Di,{children:t})}},2445:function(){}},function(e){e.O(0,[614,422,259,950,452,516,779,354,760,971,69,744],function(){return e(e.s=7085)}),_N_E=e.O()}]);